@page "/Content/TaskList"
@using TaskWithYou.Shared;

<TaskWithYou.Client.Pages.Content.EditTask @ref="EditModal" OnClose="OnRefleshList" />
<TaskWithYou.Client.Pages.Content.DeleteTask @ref="DeleteModal" OnClose="OnRefleshList" />

<h3>TaskList</h3>

@if (CanRender == true)
{
    <table class="table table-bordered">
        <thead>
            <tr>
                <th></th>
                <th>タスク名</th>
                <th>登録日</th>
                <th>期限日</th>
                <th>詳細</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var task in viewModel.TaskItems)
            {
                <tr>
                    <td class="text-center @GetColorClass(task.State.State)">
                        <p class="m-0 blight-point">●</p>
                        @task.State.Name
                    </td>
                    <td>@task.Name</td>
                    <td>@task.TourokuBi</td>
                    <td>@task.KigenBi</td>
                    <td class="text-break">@task.Detail</td>
                    <td>
                        <button type="button" class="btn btn-outline-info"
                                @onclick="@(() => EditModal.OnOpenAsync(task.Gid, EditMode.Edit))">Edit</button>

                        <button type="button" class="btn btn-outline-danger"
                                @onclick="@(() => DeleteModal.OnOpenAsync(task.Gid))">
                            Del
                        </button>
                    </td>
                </tr>
                }
        </tbody>
    </table>

        <button type="button" class="btn btn-outline-info"
                @onclick="@(() => EditModal.OnOpenAsync(Guid.Empty, EditMode.Add))">
            Add
        </button>
    }